(function(a){function c(c,d){this.defaults={classPrefix:"",width:"100%",showValue:false,showRange:false,onStart:null,onProgress:null,onEnd:null};this.options=a.extend({},this.defaults,d);this.input=a(c);this.dragging=0;this.ranged=false;this.startValue=0;this.startValueLeft=null;this.startValueRight=null;this.wrapId=null;this.handleLeftId=null;this.handleRightId=null;this.connectorId=null;this.valueId=null;this.rangeMinId=null;this.rangeMaxId=null;this.wrap=null;this.handleLeft=null;this.handleRight=null;this.connector=null;this.value=null;this.rangeMin=null;this.rangeMax=null;this.setupDom=function(){b++;this.startValue=this.input.val();if(this.startValue.indexOf(" ")!=-1){var c=this.startValue.split(" ");this.startValueLeft=parseInt(c[0]);this.startValueRight=c[1];this.startValue=this.startValueLeft;this.ranged=true}var d=this.input.attr("id");if(d==null){d=b}this.wrapId="slider-wrap-"+d;this.input.after(a("<div/>",{id:this.wrapId,"class":this.options.classPrefix+"slider-wrap"}));this.wrap=a("#"+this.wrapId);this.wrap.css({width:this.options.width});this.connectorId="slider-connector-left-"+d;this.wrap.append(a("<div/>",{id:this.connectorId,"class":this.options.classPrefix+"slider-connector-left"}));this.connector=a("#"+this.connectorId);this.handleLeftId="slider-handle-left-"+d;this.wrap.append(a("<div/>",{id:this.handleLeftId,"class":this.options.classPrefix+"slider-handle-left"}));this.handleLeft=a("#"+this.handleLeftId);if(this.ranged){this.handleRightId="slider-handle-right-"+d;this.wrap.append(a("<div/>",{id:this.handleRightId,"class":this.options.classPrefix+"slider-handle-right"}));this.handleRight=a("#"+this.handleRightId)}var e=this.input.data("min")||0,f=this.input.data("max")||100,g=this.input.data("step")||1,h=f-e,i=parseInt(this.wrap.width());if(this.ranged){var j=Math.round(this.startValueLeft/g)*g,k=(j-e)/h,l=i*k,m=Math.round(this.startValueRight/g)*g,n=(m-e)/h,o=i*n;this.handleLeft.css({left:l});this.handleRight.css({left:o});this.connector.css({left:l,width:o-l})}else{var p=Math.round(this.startValue/g)*g,q=(p-e)/h,r=i*q;this.handleLeft.css({left:r});this.connector.css({width:r})}if(this.options.showValue){this.valueId="slider-value-"+d;this.wrap.append(a("<div/>",{id:this.valueId,"class":this.options.classPrefix+"slider-value"}));this.wrap.addClass("with-value");this.value=a("#"+this.valueId);if(!this.ranged){this.value.html(this.startValue)}else{this.value.html(this.startValueLeft+" - "+this.startValueRight)}}if(this.options.showRange){this.rangeMinId="slider-range-min-"+d;this.rangeMaxId="slider-range-max-"+d;this.wrap.append(a("<div/>",{id:this.rangeMinId,"class":this.options.classPrefix+"slider-range-min"}));this.wrap.append(a("<div/>",{id:this.rangeMaxId,"class":this.options.classPrefix+"slider-range-max"}));this.wrap.addClass("with-range");this.rangeMin=a("#"+this.rangeMinId);this.rangeMax=a("#"+this.rangeMaxId);this.rangeMin.html(e);this.rangeMax.html(f)}this.input.hide()};this.setupEvents=function(){var b=this;this.handleLeft.mousedown(function(a){b.onDragStart(a);b.onDragStartLeft(a)});if(this.ranged){this.handleRight.mousedown(function(a){b.onDragStart(a);b.onDragStartRight(a)})}a(document).mousemove(function(a){b.onDragProgress(a)});a(document).mouseup(function(a){b.onDragEnd(a)})};this.onDragStart=function(b){a(document.body).addClass("slider-unselectable")};this.onDragStartLeft=function(a){this.dragging=1;if(typeof this.options.onStart=="function"){this.options.onStart("left",this.input[0])}if(typeof this.options.onStartLeft=="function"){this.options.onStartLeft(this.input[0])}};this.onDragStartRight=function(a){this.dragging=2;if(typeof this.options.onStart=="function"){this.options.onStart("right",this.input[0])}if(typeof this.options.onStartRight=="function"){this.options.onStartRight(this.input[0])}};this.onDragProgress=function(a){if(this.dragging==0){return}var b=this.wrap.position().left,c=parseInt(this.wrap.width()),d=Math.min(Math.max(a.clientX-b,0),c);if(this.ranged){var e=this.handleLeft.position().left,f=this.handleRight.position().left;if(this.dragging==1&&d>f){d=f}else if(this.dragging==2&&d<e){d=e}}var g=this.input.data("min")||0,h=this.input.data("max")||100,i=this.input.data("step")||1,j=h-g,k=d/c,l=Math.round((j*k+g)/i)*i;k=(l-g)/j;d=c*k;if(!this.ranged){this.handleLeft.css({left:d});this.connector.css({width:d});this.input.attr("value",l);if(this.options.showValue){this.value.html(l)}if(typeof this.options.onProgress=="function"){this.options.onProgress(l,this.input[0])}}else{var m=this.dragging==1?this.handleLeft:this.handleRight,n=this.input.val().split(" "),o=parseInt(n[0]),p=parseInt(n[1]);m.css({left:d});var q=this.handleLeft.position().left,r=this.handleRight.position().left;this.connector.css({left:q,width:r-q});if(this.dragging==1){o=l}else{p=l}this.input.attr("value",o+" "+p);if(this.options.showValue){this.value.html(o+" - "+p)}if(typeof this.options.onProgress=="function"){this.options.onProgress(o,p,this.input[0])}}this.input.trigger("change")};this.onDragEnd=function(b){if(this.dragging==0){return}if(typeof this.options.onEnd=="function"){this.options.onEnd(this.input.val(),this.dragging==1?"left":"right",this.input[0])}this.dragging=0;a(document.body).removeClass("slider-unselectable")}}var b=0;c.prototype={init:function(){this.setupDom();this.setupEvents()}};a.fn.slider=function(b){var d=Array.prototype.slice.call(arguments);if(this.length){this.each(function(){var e=a(this).data("slider");if(e==null){e=new c(this,b);e.init();a(this).data("slider",e)}else{if(d.length==0){return}var f=d[0];if(typeof e[f]=="function"){e[f].apply(e,d.slice(1))}}})}}})(jQuery)