(function(a){function c(c,d){this.defaults={classPrefix:"",width:"100%",showValue:false,showRange:false,onStart:null,onChange:null,onEnd:null};this.options=a.extend({},this.defaults,d);this.input=a(c);this.dragging=0;this.ranged=false;this.startValue=0;this.startValueLeft=null;this.startValueRight=null;this.wrapId=null;this.handleLeftId=null;this.handleRightId=null;this.connectorId=null;this.valueId=null;this.rangeMinId=null;this.rangeMaxId=null;this.wrap=null;this.handleLeft=null;this.handleRight=null;this.connector=null;this.value=null;this.rangeMin=null;this.rangeMax=null;this.setupDom=function(){b++;this.startValue=this.input.val();if(this.startValue.indexOf(" ")!=-1){var c=this.startValue.split(" ");this.startValueLeft=parseInt(c[0]);this.startValueRight=c[1];this.startValue=this.startValueLeft;this.ranged=true}var d=this.input.attr("id");if(d==null){d=b}this.wrapId="slider-wrap-"+d;this.input.after(a("<div/>",{id:this.wrapId,"class":this.options.classPrefix+"slider-wrap"}));this.wrap=a("#"+this.wrapId);this.wrap.css({width:this.options.width});this.connectorId="slider-connector-left-"+d;this.wrap.append(a("<div/>",{id:this.connectorId,"class":this.options.classPrefix+"slider-connector-left"}));this.connector=a("#"+this.connectorId);this.handleLeftId="slider-handle-left-"+d;this.wrap.append(a("<div/>",{id:this.handleLeftId,"class":this.options.classPrefix+"slider-handle-left"}));this.handleLeft=a("#"+this.handleLeftId);if(this.ranged){this.handleRightId="slider-handle-right-"+d;this.wrap.append(a("<div/>",{id:this.handleRightId,"class":this.options.classPrefix+"slider-handle-right"}));this.handleRight=a("#"+this.handleRightId)}if(this.options.showValue){this.valueId="slider-value-"+d;this.wrap.append(a("<div/>",{id:this.valueId,"class":this.options.classPrefix+"slider-value"}));this.wrap.addClass("with-value");this.value=a("#"+this.valueId);if(!this.ranged){this.value.html(Math.round(this.startValue*10)/10)}else{this.value.html(Math.round(this.startValueLeft*10)/10+" - "+Math.round(this.startValueRight*10)/10)}}if(this.options.showRange){var e=this.input.data("min")||0,f=this.input.data("max")||100;this.rangeMinId="slider-range-min-"+d;this.rangeMaxId="slider-range-max-"+d;this.wrap.append(a("<div/>",{id:this.rangeMinId,"class":this.options.classPrefix+"slider-range-min"}));this.wrap.append(a("<div/>",{id:this.rangeMaxId,"class":this.options.classPrefix+"slider-range-max"}));this.wrap.addClass("with-range");this.rangeMin=a("#"+this.rangeMinId);this.rangeMax=a("#"+this.rangeMaxId);this.rangeMin.html(e);this.rangeMax.html(f)}this.setValue(this.input.val());this.input.hide()};this.setupEvents=function(){var b=this;this.handleLeft.mousedown(function(a){b.onDragStart(a);b.onDragStartLeft(a)});if(this.ranged){this.handleRight.mousedown(function(a){b.onDragStart(a);b.onDragStartRight(a)})}a(document).mousemove(function(a){b.onDragProgress(a)});a(document).mouseup(function(a){b.onDragEnd(a)})};this.onDragStart=function(a){this.disableTextSelect()};this.onDragStartLeft=function(a){this.dragging=1;if(typeof this.options.onStart=="function"){this.options.onStart("left",this.input[0])}if(typeof this.options.onStartLeft=="function"){this.options.onStartLeft(this.input[0])}};this.onDragStartRight=function(a){this.dragging=2;if(typeof this.options.onStart=="function"){this.options.onStart("right",this.input[0])}if(typeof this.options.onStartRight=="function"){this.options.onStartRight(this.input[0])}};this.onDragProgress=function(a){if(this.dragging==0){return}var b=this.wrap.offset().left,c=parseInt(this.wrap.width()),d=Math.min(Math.max(a.clientX-b,0),c);if(this.ranged){var e=this.handleLeft.position().left,f=this.handleRight.position().left;if(this.dragging==1&&d>f){d=f}else if(this.dragging==2&&d<e){d=e}}var g=this.input.data("min")||0,h=this.input.data("max")||100,i=this.input.data("step")||1,j=h-g,k=d/c,l=Math.round((j*k+g)/i)*i;k=(l-g)/j;d=c*k;if(!this.ranged){this.handleLeft.css({left:d});this.connector.css({width:d});this.input.attr("value",l);if(this.options.showValue){this.value.html(Math.round(l*10)/10)}if(typeof this.options.onChange=="function"){this.options.onChange(l,this.input[0])}}else{var m=this.dragging==1?this.handleLeft:this.handleRight,n=this.input.val().split(" "),o=parseInt(n[0]),p=parseInt(n[1]);m.css({left:d});var q=this.handleLeft.position().left,r=this.handleRight.position().left;this.connector.css({left:q,width:r-q});if(this.dragging==1){o=l}else{p=l}this.input.attr("value",o+" "+p);if(this.options.showValue){this.value.html(Math.round(o*10)/10+" - "+Math.round(p*10)/10)}if(typeof this.options.onChange=="function"){this.options.onChange(o,p,this.input[0])}}this.input.trigger("change")};this.onDragEnd=function(a){if(this.dragging==0){return}if(typeof this.options.onEnd=="function"){this.options.onEnd(this.input.val(),this.dragging==1?"left":"right",this.input[0])}this.dragging=0;this.enableTextSelect()};this.setValue=function(a){this.startValue=a;if(typeof a=="string"&&a.indexOf(" ")!=-1){var b=a.split(" ");this.startValueLeft=parseInt(b[0]);this.startValueRight=b[1];this.startValue=this.startValueLeft;this.ranged=true}var c=this.input.data("min")||0,d=this.input.data("max")||100,e=this.input.data("step")||1,f=d-c,g=parseInt(this.wrap.width());if(this.ranged){if(this.startValueLeft<c){this.startValueLeft=c}if(this.startValueRight<c){this.startValueRight=c}if(this.startValueLeft>d){this.startValueLeft=d}if(this.startValueRight>d){this.startValueRight=d}var h=Math.round(this.startValueLeft/e)*e,i=(h-c)/f,j=g*i,k=Math.round(this.startValueRight/e)*e,l=(k-c)/f,m=g*l;this.handleLeft.css({left:j});this.handleRight.css({left:m});this.connector.css({left:j,width:m-j});this.input.attr("value",h+" "+k);if(this.options.showValue){this.value.html(Math.round(h*10)/10+" - "+Math.round(k*10)/10)}}else{if(this.startValue<c){this.startValue=c}else if(this.startValue>d){this.startValue=d}var n=Math.round(this.startValue/e)*e,o=(n-c)/f,p=g*o;this.handleLeft.css({left:p});this.connector.css({width:p});this.input.attr("value",a);if(this.options.showValue){this.value.html(Math.round(n*10)/10)}}};this.disableTextSelect=function(){a("*").attr("unselectable","on").css("user-select","none").on("selectstart",false).addClass("slider-unselectable")};this.enableTextSelect=function(){a("*").removeAttr("unselectable").css("user-select","").unbind("selectstart").removeClass("slider-unselectable")}}var b=0;c.prototype={init:function(){this.setupDom();this.setupEvents()},range:function(a,b,c){this.input.data("min",a);this.input.data("max",b);if(typeof c=="number"){this.input.data("step",c)}if(this.options.showRange){this.rangeMin.html(a);this.rangeMax.html(b)}this.setValue(this.input.val())},min:function(a){this.range(a,this.input.data("max"))},max:function(a){this.range(this.input.data("min"),a)},val:function(a,b){if(typeof b!="undefined"){a=parseInt(a)+" "+parseInt(b)}else if(parseInt(a)==a){a=parseInt(a)}this.setValue(a)},change:function(a){this.options.onChange=a},start:function(a){this.options.onStart=a},end:function(a){this.options.onEnd=a}};a.fn.slider=function(b){var d=Array.prototype.slice.call(arguments);if(this.length){this.each(function(){var e=a(this).data("slider");if(e==null){e=new c(this,b);e.init();a(this).data("slider",e)}else{if(d.length==0){return}var f=d[0];if(typeof e[f]=="function"){e[f].apply(e,d.slice(1))}}})}}})(jQuery)