(function(e){"use strict";function n(n,r){this.defaults={classPrefix:"",width:"100%",showValue:false,showRange:false,onStart:null,onChange:null,onEnd:null,minChangeInterval:0,decimals:1,flipswitch:false};this.input=e(n);this.step=this.input.data("step")||1;this.defaults.decimals=this.step<1?(1/this.step+"").length-1:0;this.options=e.extend({},this.defaults,r);this.dragging=0;this.ranged=false;this.startValue=0;this.startValueLeft=null;this.startValueRight=null;this.valueId=null;this.rangeMinId=null;this.rangeMaxId=null;this.wrap=null;this.handleLeft=null;this.handleLeftWidth=0;this.handleRight=null;this.connector=null;this.value=null;this.rangeMin=null;this.rangeMax=null;this.lastChangeTime=null;this.activeHandle=0;this.document=null;this.setupDom=function(){t++;this.document=e(document);this.startValue=this.input.val();if(this.startValue.indexOf(" ")!=-1){var n=this.startValue.split(" ");this.startValueLeft=parseInt(n[0],10);this.startValueRight=n[1];this.startValue=this.startValueLeft;this.ranged=true}var r=this.input.attr("id");if(typeof r!=="string"){r=t}this.wrap=e("<div/>",{id:"slider-wrap-"+r,"class":this.options.classPrefix+"slider-wrap jquery-slider"}).css({width:this.options.width});e("<div/>",{id:"slider-track-"+r,"class":this.options.classPrefix+"slider-track"}).appendTo(this.wrap);this.connector=e("<div/>",{id:"slider-connector-left-"+r,"class":this.options.classPrefix+"slider-connector-left"}).appendTo(this.wrap);this.handleLeft=e("<div/>",{id:"slider-handle-left-"+r,"class":this.options.classPrefix+"slider-handle "+this.options.classPrefix+"slider-handle-left"}).appendTo(this.wrap);if(this.ranged){this.handleRight=e("<div/>",{id:"slider-handle-right-"+r,"class":this.options.classPrefix+"slider-handle "+this.options.classPrefix+"slider-handle-right"}).appendTo(this.wrap)}if(this.options.showValue){this.valueId="slider-value-"+r;this.value=e("<div/>",{id:this.valueId,"class":this.options.classPrefix+"slider-value"}).appendTo(this.wrap);this.wrap.addClass("with-value");if(!this.ranged){this.value.text(this.round(this.startValue,this.options.decimals))}else{this.value.text(this.round(this.startValueLeft,this.options.decimals)+" - "+this.round(this.startValueRight,this.options.decimals))}}if(this.options.showRange){var i=this.input.data("min")||0,s=this.input.data("max")||100;this.rangeMinId="slider-range-min-"+r;this.rangeMaxId="slider-range-max-"+r;this.wrap.append(e("<div/>",{id:this.rangeMinId,"class":this.options.classPrefix+"slider-range-min"}));this.wrap.append(e("<div/>",{id:this.rangeMaxId,"class":this.options.classPrefix+"slider-range-max"}));this.wrap.addClass("with-range");this.rangeMin=e("#"+this.rangeMinId);this.rangeMax=e("#"+this.rangeMaxId);this.rangeMin.html(i);this.rangeMax.html(s)}this.setValue(this.input.val());this.input.hide();this.input.after(this.wrap);if(this.options.flipswitch){this.handleLeftWidth=this.handleLeft.width()}};this.setupEvents=function(){var t=this;this.handleLeft.on("mousedown touchstart",function(e){t.onDragStartLeft(e);t.activeHandle=1;t.bindEventsTo(t.handleLeft,e)});if(this.ranged){this.handleRight.on("mousedown touchstart",function(e){t.onDragStartRight(e);t.activeHandle=2;t.bindEventsTo(t.handleRight,e)})}e(document).keydown(function(e){t.onKeyDown(e)});this.wrap.on("click tap",function(e){t.jumpTo(t.getClientX(e))})};this.bindEventsTo=function(t,n){var r=this,i;t.addClass("slider-handle-active");this.onDragStart(n);this.document.on("mousemove touchmove",function(e){r.onDragProgress(e)});e(document).one("mouseup touchend",function(e){r.document.off("mousemove touchmove");t.removeClass("slider-handle-active");r.onDragEnd(e)});for(i=0;i<window._jQsliders.length;i++){window._jQsliders[i].activeHandle=0}n.preventDefault();return false};this.onDragStart=function(){this.disableTextSelect()};this.onDragStartLeft=function(){this.dragging=1;if(typeof this.options.onStart=="function"){this.options.onStart("left",this.input[0])}if(typeof this.options.onStartLeft=="function"){this.options.onStartLeft(this.input[0])}};this.onDragStartRight=function(){this.dragging=2;if(typeof this.options.onStart=="function"){this.options.onStart("right",this.input[0])}if(typeof this.options.onStartRight=="function"){this.options.onStartRight(this.input[0])}};this.getClientX=function(e){if(typeof e.clientX==="undefined"){return e.originalEvent.touches[0].pageX}else{return e.clientX}};this.onDragProgress=function(e){if(this.dragging===0){return}var t=this.wrap.offset().left,n=parseInt(this.wrap.width(),10),r=Math.min(Math.max(this.getClientX(e)-t,0),n),i;if(this.ranged){var s=this.handleLeft.position().left,o=this.handleRight.position().left;if(this.dragging===1&&r>o){r=o}else if(this.dragging===2&&r<s){r=s}}var u=this.input.data("min")||0,a=this.input.data("max")||100,f=this.input.data("step")||1,l=a-u,c=r/n,h=Math.round((l*c+u)/f)*f,p,d;c=(h-u)/l;r=n*c;i=r;if(this.options.flipswitch&&r>this.handleLeftWidth){r-=this.handleLeftWidth}if(this.options.flipswitch&&r>this.handleLeftWidth/2){i-=this.handleLeftWidth/2}if(!this.ranged){this.handleLeft.css({left:r});this.connector.css({width:i});this.input.attr("value",h);if(this.options.showValue){this.value.html(this.round(h,this.options.decimals))}if(typeof this.options.onChange=="function"){if(this.options.minChangeInterval===0){this.options.onChange(h,this.input[0])}else{p=this.getMillitime();d=p-this.lastChangeTime;if(this.options.minChangeInterval===null||d>=this.options.minChangeInterval){this.options.onChange(h,this.input[0]);this.lastChangeTime=p}}}}else{var v=this.dragging==1?this.handleLeft:this.handleRight,m=this.input.val().split(" "),g=parseInt(m[0],10),y=parseInt(m[1],10);v.css({left:r});var b=this.handleLeft.position().left,w=this.handleRight.position().left;this.connector.css({left:b,width:w-b});if(this.dragging==1){g=h}else{y=h}this.input.attr("value",g+" "+y);if(this.options.showValue){this.value.html(this.round(g,this.options.decimals)+" - "+this.round(y,this.options.decimals))}if(typeof this.options.onChange=="function"){this.options.onChange(g,y,this.input[0])}if(typeof this.options.onChange=="function"){if(this.options.minChangeInterval===0){this.options.onChange(g,y,this.input[0])}else{p=this.getMillitime();d=p-this.lastChangeTime;if(this.options.minChangeInterval===null||d>=this.options.minChangeInterval){this.options.onChange(g,y,this.input[0]);this.lastChangeTime=p}}}}this.input.trigger("change")};this.onDragEnd=function(){if(this.dragging===0){return}if(typeof this.options.onEnd=="function"){this.options.onEnd(this.input.val(),this.dragging==1?"left":"right",this.input[0])}this.dragging=0;this.enableTextSelect()};this.onKeyDown=function(e){if(this.activeHandle===0||e.keyCode!=37&&e.keyCode!=39){return}var t=this.input.val(),n,r,i;if(this.ranged){n=parseInt(t.split(" ")[0],10);r=parseInt(t.split(" ")[1],10);if(this.activeHandle==1){i=n}else{i=r}}else{n=parseInt(t,10);i=n}var s=parseInt(this.input.data("min"),10)||0,o=parseInt(this.input.data("max"),10)||100,u=parseInt(this.input.data("step"),10)||1;if(e.shiftKey){u*=10}if(e.keyCode==37){i=Math.max(i-u,s)}else{i=Math.min(i+u,o)}if(this.ranged){if(this.activeHandle==1){if(i>r){i=r}this.setValue(i+" "+r)}else{if(i<n){i=n}this.setValue(n+" "+i)}}else{this.setValue(i)}};this.jumpTo=function(e){if(this.dragging!==0){return}var t=this.wrap.offset().left,n=parseInt(this.wrap.width(),10),r=Math.min(Math.max(e-t,0),n),i={clientX:e};for(var s=0;s<window._jQsliders.length;s++){window._jQsliders[s].activeHandle=0}this.dragging=!this.ranged||r<n/2?1:2;this.activeHandle=this.dragging;this.onDragProgress(i);this.dragging=0};this.setValue=function(e){this.startValue=e;if(typeof e=="string"&&e.indexOf(" ")!=-1){var t=e.split(" ");this.startValueLeft=parseInt(t[0],10);this.startValueRight=t[1];this.startValue=this.startValueLeft;this.ranged=true}var n=this.input.data("min")||0,r=this.input.data("max")||100,i=this.input.data("step")||1,s=r-n,o=parseInt(this.wrap.width(),10);if(this.ranged){if(this.startValueLeft<n){this.startValueLeft=n}if(this.startValueRight<n){this.startValueRight=n}if(this.startValueLeft>r){this.startValueLeft=r}if(this.startValueRight>r){this.startValueRight=r}var u=Math.round(this.startValueLeft/i)*i,a=(u-n)/s,f=o*a,l=Math.round(this.startValueRight/i)*i,c=(l-n)/s,h=o*c;this.handleLeft.css({left:f});this.handleRight.css({left:h});this.connector.css({left:f,width:h-f});this.input.attr("value",u+" "+l);if(this.options.showValue){this.value.html(this.round(u,this.options.decimals)+" - "+this.round(l,this.options.decimals))}if(typeof this.options.onChange=="function"){this.options.onChange(u,l,this.input[0])}}else{if(this.startValue<n){this.startValue=n}else if(this.startValue>r){this.startValue=r}var p=Math.round(this.startValue/i)*i,d=(p-n)/s,v=o*d;this.handleLeft.css({left:v});this.connector.css({width:v});this.input.attr("value",e);if(this.options.showValue){this.value.html(this.round(p,this.options.decimals))}if(typeof this.options.onChange=="function"){this.options.onChange(p,this.input[0])}}this.input.trigger("change")};this.disableTextSelect=function(){e("*").attr("unselectable","on").css("user-select","none").on("selectstart",false).addClass("slider-unselectable")};this.enableTextSelect=function(){e("*").removeAttr("unselectable").css("user-select","").unbind("selectstart").removeClass("slider-unselectable")};this.getMillitime=function(){return(new Date).getTime()};this.round=function(e,t){if(typeof e!=="number"){return e}return e.toFixed(t)}}var t=0;n.prototype={init:function(){if(typeof window._jQsliders=="undefined"){window._jQsliders=[]}window._jQsliders.push(this);this.setupDom();this.setupEvents()},range:function(e,t,n){this.input.data("min",e);this.input.data("max",t);if(typeof n=="number"){this.input.data("step",n)}if(this.options.showRange){this.rangeMin.html(e);this.rangeMax.html(t)}this.setValue(this.input.val())},min:function(e){this.range(e,this.input.data("max"))},max:function(e){this.range(this.input.data("min"),e)},val:function(e,t){if(typeof t!="undefined"){e=parseInt(e,10)+" "+parseInt(t,10)}else if(parseInt(e,10)==e){e=parseInt(e,10)}this.setValue(e)},change:function(e){this.options.onChange=e},start:function(e){this.options.onStart=e},end:function(e){this.options.onEnd=e}};e.fn.slider=function(t){var r=Array.prototype.slice.call(arguments);if(this.length){this.each(function(){var i=e(this).data("slider");if(typeof i!=="object"){i=new n(this,t);i.init();e(this).data("slider",i)}else{if(r.length===0){return}var s=r[0];if(typeof i[s]=="function"){i[s].apply(i,r.slice(1))}}})}return this}})(jQuery)